# 08. 자바스크립트 MV\*패턴

기본 아키텍처 패턴은 MVC(Model-View-Controller), MVP(Model-View-Presenter), MVVM(Model-View-ViewModel)을 살펴본다.

## 8.1 MVC 패턴

MVC 패턴은 애플리케이션의 구조를 개선하기 위해 관심사의 분리를 활용하는 아키텍쳐 디자인 패턴이다.

비즈니스 데이터(Model)과 UI(View)를 분리하고, 세번째 구성 요소(Controller)가 로직과 사용자 입력을 관리하는 구조이다.

## 8.1.1 Smalltalk-80의 MVC 패턴

Smalltalk-80에서 구현된 MVC는 애플리케이션의 로직과 UI를 분리하는 것을 목표로 했다. 이러한 설계의 기본 개념은 애플리케이션의 일부분을 분리함으로써 모델을 애플리케이션의 다른 인터페이스에서도 재사용할 수 있다는 점이다.

**SmallTalk-80의 특징**

- Model: 도메인 관련 데이터를 표현했으며 UI에 대해서는 관여하지 않는다.
- View: 모델의 현재 상태를 표현한다. 화면에 표시데는 요소는 언제나 뷰-컨트롤러 한 쌍이 존재한다.
- Controller: 사용자의 상호작용을 처리하고 뷰에 무엇을 보여줄지, 사용자 입력을 어떻게 처리할지 등을 결정하는 역할을 한다.

## 8.2 자바스크립트의 MVC

현재 자바스크립트는 MVC를 지원하는 여러 프레임워크를 갖추고 있다.

### 8.2.1 모델

모델은 비즈니스 데이터와 주로 관련이 있으며, 애플리케이션의 데이터를 관리하는 역할을 한다. UI나 프레젠테이션 계층은 담당하지 않고, 애플리케이션에 필요한 고유 데이터 형식을 나타낸다.

모델이 변경될 때 관찰자에게 변경사항을 알린다. 이렇게 함으로써 관찰자가 변경된 내용에 알맞게 능동적으로 대응할 수 있게끔 한다.

### 8.2.2 뷰

뷰는 모델에 대한 시각적인 표현으로, 현재 상태의 특정 부분만 보여준다. 일반적으로 뷰는 모델을 관찰하고, 모델에 변화가 생기면 알림을 받는다.

### 8.2.3 템플릿

태그 템플릿 리터럴을 사용하면 자바스크립트의 템플릿 리터럴 문법과 함께 템플릿을 조작하고 데이터를 채우는 데 사용할 수 있는 커스텀 처리 함수를 통해 재사용 가능한 템플릿을 만들 수 있다.

> 템플릿 자체가 뷰는 아니라는 점을 명시해야 한다.

템플릿은 뷰를 생성하기 위해 사용될 수 있다.  
태그 템플릿 리터럴과 같은 최신 템플릿 기법은 자바스크립트 애플리케이션에서 동적인 HTML 콘텐츠를 깔끔하고, 효율적이며, 유지보수가 용이한 방식으로 만들 수 있도록 해준다.

### 8.2.4 컨트롤러

컨트롤러는 모델과 뷰 사이의 중재자 역할을 하며, 애플리케이션 내에서 모델과 뷰 간의 로직과 연동을 관리한다.

## 8.3 MVC를 사용하는 이유는?

- 전반적인 유지보수의 단순화
- 모델과 뷰의 분리
- 애플리케이션 전반에서 하위 수준의 모델 및 컨트롤러 코드 중복 제거
- 모듈화를 통해 코어 로직을 담당하는 개발자와 UI작업을 담당하는 개발자가 동시에 작업 할 수 있음

## 8.4 자바스크립트와 Smalltalk-80의 MVC

대부분의 최신 자바스크립트 프레임워크는 웹 애플리케이션 개발의 다양한 요구사항에 맞추기 위해 MVC 패러다임을 발전시키려고 한다. 하지만 Smalltalk-80에서 찾을 수 있는 패턴의 순수한 형태를 고수하려는 프레임워크도 있다.

## 8.5 MVC 정리

새로운 자바스크립트 MVC/MV\* 프레임워크를 검토할 때는, 프레임워크의 아키텍처 접근 방식을 살펴보는 것이 유용할 수 있다. 특히 모델, 뷰, 컨트롤러 등 기타 요소들을 구현하는 방식을 중점적으로 본다면, 프레임워크를 가장 효과적으로 사용하는 방법을 더 잘 이해할 수 있을 것이다.

## 8.6 MVP 패턴

MVP(Model-View-Presenter)패턴은 프레젠테이션 로직의 개선에 초점을 맞춘 MVC 디자인 패턴의 파생이다.

### 8.6.1 모델, 뷰, 프리젠터

프리젠터는 뷰에 대한 UI 비즈니스 로직을 담당하는 구성요소이다. 프리젠터는 뷰와 분리되어 있으며, 인터페이스를 통해 뷰와 통신한다. 이 방식은 단위테스트에서 뷰를 Mocking 할 수 있는 등의 많은 장점을 제공한다.

MVP는 주로 '둔한' 수동형 뷰를 활용하는 구현 방식이 널리 사용된다.

### 8.6.2 MVP vs MVC

- MVP는 일반적으로 프레젠테이션 로직을 최대한 재사용해야 하는 엔터프라이즈 수준의 애플리케이션에서 사용된다.(뷰가 매우 복잡하고 사용자와의 상호작용이 많은 애플리케이션에서는 여러 컨트롤러에 크게 의존해야 할 수 있기 때문에 MVC가 적합하지 않을 수 있다.)
- MVP패턴을 사용하면 개발자는 디자이너가 애플리케이션의 레이아웃과 그래픽을 완성하기를 기다리지 않고도 프레젠테이션 로직을 작성할 수 있다.
- MVP는 구현 방식에 따라 MVC보다 단위 테스트가 더 쉬울 수 있다.

## 8.7 MVVM 패턴

MVVM(Model-View-ViewModel)패턴은 MVC아 MVP를 기반으로 하는 아키텍처 패턴으로, 애플리케이션의 UI 개발 부분과 비즈니스 로직, 도작 부분을 명확하게 분리한다.

### 8.7.1 역사

MVVM 패턴은 원래 마이크로소프트에 의해 윈도우 프레젠테이션 파운데이션(WPF)과 SilverLight 용도로 발명되었다.

### 8.7.2 모델

다른 MV\*패턴들과 마찬가지로 애플리케이션이 사용할 도메인 관련 데이터나 정보를 제공한다.

### 8.7.3 뷰

뷰는 애플리케이션에서 사용자가 상호작용하는 유일한 부분이고, 뷰 모델의 상태를 표현하는 상호작용이 가능한 UI이다.

### 8.7.4 뷰모델

뷰모델은 데이터 변환기의 역할을 하는 특수한 컨트롤러로 볼 수 있다. 모델의 정보를 뷰가 사용할 수 있는 형태로 변환하고, 뷰에서 발생한 명령을 모델로 전달한다.

뷰모델은 뷰라기보다는 모델에 더 가깝다고 볼 수 있다. 그러나 동시에 뷰의 디스플레이 로직 대부분을 처리한다.

### 8.7.5 뷰와 뷰모델 복습

뷰와 뷰모델은 데이터 바인딩과 이벤트를 통해 소통한다.

뷰모델은 모델의 속성을 단순히 제공하는 것뿐만 아니라, 데이터 유효성 검사같은 다른 메서드와 기능에 대한 접근도 허용한다.

뷰는 자체 UI 이벤트를 처리하고, 필요에 따라 뷰모델에 연결한다.

### 8.7.6 뷰모델 vs 모델

뷰모델은 데이터 바인딩을 위해 모델 또는 모델의 속성을 가져올 수 있고, 뷰에 제공되는 속성을 가져오거나 조작하기 위한 인터페이스를 포함할 수 있다.

## 8.8 장단점

### 8.8.1 장점

- MVVM은 UI와 이를 구동하게 해주는 요소를 동시에 개발할 수 있도록 한다.
- MVVM은 뷰를 추상화함으로써 뷰의 뒤에 작성되는 비즈니스 로직의 양을 줄여준다.
- 뷰모델은 이벤트 중심 코드에 비해 단위 테스트가 더 쉽다.
- 뷰모델은 UI 자동화나 상호작용에 대한 고려 없이도 테스트가 가능한다.

### 8.8.2 단점

- 단순한 UI의 겨웅, MVVM은 과도한 구현이 될 수 있다.
- 데이터 바인딩은 선언적이고 사용하기 편리할 수 있지만, 단순히 중단점을 설정하는 명령형 코드에 비해 디버깅이 더 어려울 수 있다.
- 복잡한 애플리케이션에서는 데이어 바인딩이 상당한 관리 부담을 만들어 낼 수 있다.
- 대규모 애플리케이션에서는 필요한 일반화를 제공하기 위해 뷰모델을 미리 설계하는 것이 어려울 수 있다.

## 8.9 MVC vs MVP vs MVVM

MVP와 MVVM은 모두 MVC에서 파생된 패턴이다.

MVC에서 전체 모델을 뷰에 노출하는 것은 애플리케이션의 복잡도에 따라 보안 및 성능에 문제를 일으킬수 있다. 이러한 문제를 피하기 위한 패턴이 MVVM이다. MVVM을 사용하면 상태과 로직 정보를 포함할 수 있는 뷰와 관련된 모델 일부를 생성할 수 있다.

MVP에서는 컨트롤러의 역할이 프리젠터로 대체된다. MVVM과 달리 뷰와 뷰모델을 바인딩하는 메커니즘이 없기 때문에, 각 뷰는 프리젠터가 뷰와 상호작용할 수 있도록 인터페이스를 구현한다.

## 8.10 최신 MV\* 패턴

리액트나 Vue.js와 같은 최신 라이브러리와 프레임워크는 애플리케이션의 뷰 또는 프레젠테이션 계층을 구성한다. 대부분의 경우에 이 프레임워크들은 모델 구현 방식과 애플리케이션의 상태 관리에 대해 유연하다.

> vue.js는 공식적으로 뷰모델을 사용하는 MVVM패턴이라고 주장한다.

### 8.10.1 MV\* 패턴과 리액트

리액트는 MVC 프레임워크가 아니다. 리액트를 MVC 디자인패턴에서 사용하지 않는 이유는 리액트에서는 서버가 브라우저에 '뷰'를 직접 재공하지 않고, '데이터'를 제공하기 때문에다. 리액트는 이 데이터를 브라우저에서 구문 분석하여 실제 뷰를 생성한다. 이러한 관점에서, 리엑트를 MVC 패턴의 뷰(V)라고 할 수 있지만, 전통적인 의미에서의 MVC 프레임워크는 아니다.

## 8.11 마치며

기본 패턴의 이해는 전체 웹 애플리케이션의 아케틱처를 설계하는 데 기초적 가이드라인을 제공할 수 있다. 또한 애플리케이션을 수직 분할하여 다수의 컴포넌트로 구성할 때, 개별 프론트엔드 컴포넌트에 뷰모델이나 모델의 개념을 적용하여 컴포넌트의 뷰를 구성하는 데에 도움을 줄 수 있다.
